#!/bin/sh

staged_files=$(git diff --staged --name-only)

./gradlew ktlintFormat

echo "ğŸ§¹ Running Gradle build and checks on staged filesâ€¦"
./gradlew build

if [ $? -ne 0 ]; then
  echo "âŒ Build or checks failed. Please fix the issues before committing."
  exit 1
fi

for file in $staged_files; do
  if test -f "$file"; then
    git add "$file"
  fi
done

echo "âœ… Pre-commit check passed successfully."
